# EO Services

Веб-платформа для орбитального анализа и планирования дистанционного зондирования Земли (ДЗЗ).

**Live:** [earthfrom.space](https://earthfrom.space)

---

## Обзор

EO Services — набор инструментов для инженеров, операторов и исследователей, работающих с космическими аппаратами ДЗЗ. Платформа включает расчёт орбитальных параметров, прогнозирование пролётов, моделирование покрытия территорий и проектирование орбитальных группировок.

Все вычисления выполняются на стороне клиента (браузер), серверная часть используется только для проксирования запросов к Space-Track API.

## Архитектура

```
┌─────────────────────────────────────────────┐
│  Frontend (SPA)                             │
│  React 19 + Vite 7 + React Router 7        │
│                                             │
│  ┌──────────┐ ┌──────────┐ ┌──────────────┐│
│  │satellite.js│ │ recharts │ │ Three.js CDN ││
│  │  (SGP4)   │ │ (графики)│ │ (3D рендер)  ││
│  └──────────┘ └──────────┘ └──────────────┘│
└──────────────────┬──────────────────────────┘
                   │ /api/spacetrack/*
┌──────────────────▼──────────────────────────┐
│  Backend (FastAPI)                          │
│  Прокси к Space-Track.org                   │
│  Порт 8083 (systemd: eo-api.service)       │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│  Nginx                                      │
│  Статика: /var/www/eo-services/             │
│  API прокси: /eo_services/api/ → :8083      │
│  SSL: Let's Encrypt (certbot)               │
└─────────────────────────────────────────────┘
```

## Модули

### 1. История орбиты (`OrbitHistory`)
Анализ эволюции орбитальных параметров КА по архиву TLE из Space-Track.

- Парсинг TLE: извлечение кеплеровых элементов (a, e, i, Ω, ω, M)
- Расчёт производных: высота перигея/апогея, период, прецессия RAAN
- Детекция манёвров: автоматическое определение по скачкам параметров
- Графики: Canvas-рендеринг временных рядов с масштабированием
- Прогноз: экстраполяция деградации орбиты

**Зависимости:** satellite.js (SGP4/SDP4), Space-Track API (backend)

### 2. Калькулятор ОГ (`OGCalc`)
Расчёт характеристик орбитальной группировки — 4 вкладки:

| Вкладка | Описание |
|---------|----------|
| Покрытие | Периодичность покрытия территории (f-критерий, φ_гр, T_п) |
| Оперативность | Оперативность наблюдения: ΔL, T_обз, количество витков |
| Инф. потоки | Расчёт объёмов данных: разрешение → поток → бортовая память |
| Производительность | Площадная производительность съёмки по полосе захвата |

**Методика:** Классические формулы баллистики ДЗЗ (Лысенко, Охоцимский)

### 3. Конструктор группировок (`OrbitDesigner`)
3D-визуализация орбитальных группировок с интерактивным управлением.

- Three.js: WebGL-рендер Земли с текстурой + орбиты
- Конфигурации: Walker Star/Delta, Sun-synchronous, произвольные
- Параметры: высота, наклонение, количество КА/плоскостей
- Экспорт: TLE-формат генерируемых орбит
- Анимация: вращение Земли и движение КА в реальном времени

**Зависимости:** Three.js r128 (CDN), earth_texture.jpg (equirectangular 2000×1000)

### 4. Расчёт покрытия (`Coverage`)
Планировщик съёмки ДЗЗ — моделирование покрытия территорий группировкой КА.

- Пропагация: аналитическая модель с J2-возмущениями
- Конфигурации: одна плоскость, разные плоскости, Walker Delta, автоподбор
- Регионы: Московская обл., СПб, Краснодар, Свердловская, Новосибирская, Якутия, ХМАО, ЯНАО, Мурманская, Камчатка, Крым, Россия (целиком)
- Режимы: покрытие территории / анализ конкретной точки
- Графики: динамика покрытия, распределение проходов по часам (recharts)
- Оптимизация: перебор конфигураций по критерию макс. покрытия или мин. интервала

**Зависимости:** recharts (LineChart, BarChart)

### 5. Прогноз пролётов (`PassCalc`)
Расчёт видимых пролётов КА над точкой наблюдения.

- SGP4-пропагация: satellite.js с пошаговым поиском пролётов
- TLE-база: 25+ спутников (МКС, CSS, МЕТЕОР-М, NOAA, METOP, Ресурс-П, Канопус-В, ГЛОНАСС, Hubble, Электро-Л, Арктика-М)
- Карта: SVG equirectangular проекция с earth_texture.jpg
- Визуализация: наземная трасса, положение Солнца, терминатор день/ночь
- Пролёты: AOS/TCA/LOS с азимутами и углами места
- График: elevation vs time для выбранного пролёта
- Города: 21 город России с предустановленными координатами

**Зависимости:** satellite.js

## Стек

| Компонент | Технология | Версия |
|-----------|-----------|--------|
| UI | React | 19.2 |
| Роутинг | React Router | 7.13 |
| Сборка | Vite | 7.2 |
| CSS | Tailwind CSS | 4.1 |
| Орбитальная механика | satellite.js | 6.0.2 |
| Графики | recharts | 3.7 |
| 3D | Three.js | r128 (CDN) |
| Backend | FastAPI | 0.115 |
| HTTP-клиент | httpx | 0.28 |
| Web-сервер | Nginx | — |
| SSL | Let's Encrypt (certbot) | — |

## Структура проекта

```
eo-services/
├── src/
│   ├── App.jsx              # Роутер, навигация, lazy loading
│   ├── main.jsx             # Точка входа
│   ├── index.css            # CSS-переменные, светлая тема
│   ├── pages/
│   │   ├── Home.jsx         # Главная с карточками сервисов
│   │   ├── OrbitHistory.jsx # История орбиты (Space-Track)
│   │   ├── OGCalc.jsx       # Калькулятор ОГ (4 вкладки)
│   │   ├── OrbitDesigner.jsx# 3D конструктор группировок
│   │   ├── Coverage.jsx     # Планировщик покрытия ДЗЗ
│   │   └── PassCalc.jsx     # Прогноз пролётов
│   ├── components/          # Общие компоненты
│   └── services/            # API-клиенты
├── backend/
│   ├── main.py              # FastAPI, прокси Space-Track
│   ├── requirements.txt     # Python-зависимости
│   └── eo-api.service       # systemd unit
├── deploy/
│   ├── deploy.sh            # Скрипт деплоя
│   ├── nginx-location.conf  # Nginx location для статики
│   └── nginx-api.conf       # Nginx прокси для API
├── public/
│   ├── earth_texture.jpg    # Текстура Земли (208 KB, 2000×1000)
│   └── textures/            # Дополнительные текстуры
├── package.json
└── vite.config.js           # base: '/eo_services/'
```

## Установка и запуск

### Локально (разработка)

```bash
git clone https://github.com/SizovOleg/eo-services.git
cd eo-services
npm install
npm run dev
```

Откроется на `http://localhost:5173/eo_services/`

### Сборка

```bash
npm run build
```

Результат в `dist/` — статический SPA, готовый к деплою.

### Backend (опционально, для OrbitHistory)

```bash
cd backend
pip install -r requirements.txt
export SPACETRACK_USER="your_login"
export SPACETRACK_PASS="your_password"
uvicorn main:app --host 127.0.0.1 --port 8083
```

### Деплой на сервер

```bash
# Сборка и копирование
npm run build
scp -r dist/* user@server:/var/www/eo-services/

# Nginx конфиг (добавить в server {})
location /eo_services/ {
    alias /var/www/eo-services/;
    index index.html;
    try_files $uri $uri/ /eo_services/index.html;
}

# API прокси (если нужен OrbitHistory)
location /eo_services/api/ {
    proxy_pass http://127.0.0.1:8083/api/;
}
```

## Дизайн

Светлая тема с CSS-переменными:

| Переменная | Значение | Назначение |
|-----------|----------|-----------|
| `--bg` | `#f4f5f7` | Фон страницы |
| `--bg-white` | `#ffffff` | Карточки, панели |
| `--bg-input` | `#f8f9fb` | Поля ввода |
| `--border` | `#e0e4ea` | Границы элементов |
| `--text` | `#1a1f2e` | Основной текст |
| `--accent` | `#0077cc` | Кнопки, ссылки |
| `--success` | `#0fa968` | Статус online |
| `--warning` | `#d68a00` | Предупреждения |
| `--danger` | `#d63b50` | Ошибки |

Шрифты: **Exo 2** (основной), **JetBrains Mono** (TLE, код).

## Математические модели

### SGP4/SDP4 (satellite.js)
Стандартная модель NORAD для пропагации орбит по TLE. Учитывает:
- Гравитационные гармоники (J2, J3, J4)
- Атмосферное торможение
- Лунно-солнечные возмущения (для высоких орбит, SDP4)

### J2-аналитическая модель (Coverage)
Упрощённая модель для быстрого моделирования покрытия:
- Прецессия RAAN: `dΩ/dt = -1.5·n·J2·(Rₑ/p)²·cos(i)`
- Прецессия аргумента перигея: `dω/dt = 0.75·n·J2·(Rₑ/p)²·(5cos²i - 1)`
- Уравнение Кеплера: итерационное решение для эксцентрической аномалии

### Солнечная позиция (PassCalc)
Аппроксимация на основе юлианской даты:
- Эклиптическая долгота Солнца
- Склонение из наклона эклиптики
- Терминатор: геометрическое построение по подсолнечной точке

## Лицензия

MIT

## Автор

[SizovOleg](https://github.com/SizovOleg)
